source code for partial shape matching